{% extends 'website/base.html' %}
{% load static %}

{% block title %}IA Assistant - Sistema JAM{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-gradient-primary text-white">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h1 class="display-4 mb-2">
                                <i class="fas fa-robot me-3"></i>
                                IA Assistant
                            </h1>
                            <p class="lead mb-0">Sistema de Intelig√™ncia Artificial mais avan√ßado do mundo</p>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="stats-card bg-white bg-opacity-25 rounded p-3">
                                <h3 class="text-white mb-0">{{ stats.conversas_hoje }}</h3>
                                <small class="text-white-50">Conversas hoje</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <i class="fas fa-chart-line fa-3x text-primary mb-3"></i>
                    <h4 class="text-primary">{{ stats.predicoes_acuradas }}%</h4>
                    <p class="text-muted mb-0">Precis√£o das Predi√ß√µes</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <i class="fas fa-cogs fa-3x text-success mb-3"></i>
                    <h4 class="text-success">{{ stats.automacoes_ativas }}</h4>
                    <p class="text-muted mb-0">Automa√ß√µes Ativas</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <i class="fas fa-clock fa-3x text-warning mb-3"></i>
                    <h4 class="text-warning">{{ stats.tempo_economizado }}h</h4>
                    <p class="text-muted mb-0">Tempo Economizado</p>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <i class="fas fa-brain fa-3x text-info mb-3"></i>
                    <h4 class="text-info">24/7</h4>
                    <p class="text-muted mb-0">IA Sempre Ativa</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <!-- Chat IA -->
        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-comments me-2"></i>
                        Chat com IA
                    </h5>
                </div>
                <div class="card-body">
                    <div id="chat-messages" class="chat-container mb-3" style="height: 300px; overflow-y: auto;">
                        <div class="chat-message ai-message">
                            <div class="message-content">
                                <i class="fas fa-robot text-primary me-2"></i>
                                Ol√°! Sou sua assistente de IA. Como posso ajudar hoje?
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <input type="text" id="chat-input" class="form-control" placeholder="Digite sua pergunta...">
                        <button class="btn btn-primary" onclick="sendMessage()">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Preditivo -->
        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-bar me-2"></i>
                        Analytics Preditivo
                    </h5>
                </div>
                <div class="card-body">
                    <div class="prediction-item mb-3">
                        <h6 class="text-success">üìà Vendas Pr√≥ximos 30 Dias</h6>
                        <div class="progress mb-2">
                            <div class="progress-bar bg-success" style="width: 85%"></div>
                        </div>
                        <small class="text-muted">Previs√£o: R$ 125.000 (+15%)</small>
                    </div>
                    <div class="prediction-item mb-3">
                        <h6 class="text-warning">üìä Produtos Mais Vendidos</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-star text-warning me-2"></i>Produto A - 450 unidades</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Produto B - 320 unidades</li>
                            <li><i class="fas fa-star text-warning me-2"></i>Produto C - 280 unidades</li>
                        </ul>
                    </div>
                    <div class="prediction-item">
                        <h6 class="text-info">üéØ Tend√™ncias de Mercado</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-arrow-up text-success me-2"></i>Crescimento de 15% em vendas online</li>
                            <li><i class="fas fa-arrow-up text-success me-2"></i>Aumento de 8% na demanda premium</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Automa√ß√µes e Vis√£o Computacional -->
    <div class="row">
        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="fas fa-cogs me-2"></i>
                        Automa√ß√µes Inteligentes
                    </h5>
                </div>
                <div class="card-body">
                    {% for automacao in automacoes %}
                    <div class="automation-item mb-3 p-3 border rounded">
                        <h6 class="text-warning">{{ automacao.nome }}</h6>
                        <p class="text-muted small mb-2">{{ automacao.descricao }}</p>
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted">Trigger: {{ automacao.trigger }}</small>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">A√ß√£o: {{ automacao.acao }}</small>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-eye me-2"></i>
                        Vis√£o Computacional
                    </h5>
                </div>
                <div class="card-body">
                    <div class="vision-stats mb-3">
                        <div class="row text-center">
                            <div class="col-4">
                                <h4 class="text-info">98%</h4>
                                <small class="text-muted">Precis√£o</small>
                            </div>
                            <div class="col-4">
                                <h4 class="text-success">2.3s</h4>
                                <small class="text-muted">Tempo M√©dio</small>
                            </div>
                            <div class="col-4">
                                <h4 class="text-warning">5.2k</h4>
                                <small class="text-muted">An√°lises</small>
                            </div>
                        </div>
                    </div>
                    <div class="vision-example">
                        <h6 class="text-info">√öltimas An√°lises</h6>
                        <div class="analysis-item p-2 border rounded mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Produto A - Qualidade: 98% (Aprovado)
                        </div>
                        <div class="analysis-item p-2 border rounded mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Produto B - Qualidade: 95% (Aprovado)
                        </div>
                        <div class="analysis-item p-2 border rounded">
                            <i class="fas fa-times-circle text-danger me-2"></i>
                            Produto C - Qualidade: 87% (Rejeitado)
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.chat-container {
    background: #f8f9fa;
    border-radius: 10px;
    padding: 15px;
}

.chat-message {
    margin-bottom: 15px;
}

.ai-message .message-content {
    background: #e3f2fd;
    padding: 10px 15px;
    border-radius: 15px;
    display: inline-block;
    max-width: 80%;
}

.user-message .message-content {
    background: #f3e5f5;
    padding: 10px 15px;
    border-radius: 15px;
    display: inline-block;
    max-width: 80%;
    margin-left: auto;
    text-align: right;
}

.prediction-item {
    border-left: 4px solid #28a745;
    padding-left: 15px;
}

.automation-item {
    background: #fff3cd;
    border-color: #ffeaa7 !important;
}

.analysis-item {
    background: #f8f9fa;
}
</style>

<script>
function sendMessage() {
    const input = document.getElementById('chat-input');
    const message = input.value.trim();
    
    if (message) {
        // Adicionar mensagem do usu√°rio
        addMessage(message, 'user');
        
        // Simular resposta da IA
        setTimeout(() => {
            const responses = [
                "Analisando seus dados, posso sugerir otimiza√ß√µes no estoque...",
                "Baseado no hist√≥rico de vendas, recomendo focar nos produtos A e B...",
                "Detectei uma tend√™ncia de crescimento de 15% nas vendas online...",
                "Sua margem de lucro pode ser melhorada em 8% com as estrat√©gias corretas...",
                "Identifiquei 3 oportunidades de redu√ß√£o de custos..."
            ];
            const randomResponse = responses[Math.floor(Math.random() * responses.length)];
            addMessage(randomResponse, 'ai');
        }, 1000);
        
        input.value = '';
    }
}

function addMessage(text, sender) {
    const container = document.getElementById('chat-messages');
    const messageDiv = document.createElement('div');
    messageDiv.className = `chat-message ${sender}-message`;
    
    const icon = sender === 'ai' ? 'fas fa-robot text-primary me-2' : 'fas fa-user text-purple me-2';
    
    messageDiv.innerHTML = `
        <div class="message-content">
            <i class="${icon}"></i>
            ${text}
        </div>
    `;
    
    container.appendChild(messageDiv);
    container.scrollTop = container.scrollHeight;
}

// Permitir envio com Enter
document.getElementById('chat-input').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        sendMessage();
    }
});
</script>
{% endblock %} 